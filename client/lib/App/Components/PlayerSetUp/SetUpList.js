Object.defineProperty(exports,"__esModule",{value:true});exports.default=undefined;var _jsxFileName="src/App/Components/PlayerSetUp/SetUpList.js";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require("react");var _react2=_interopRequireDefault(_react);var _reactNative=require("react-native");var _ramda=require("ramda");var _reactNativeElements=require("react-native-elements");var _NavButton=require("../NavButton");var _NavButton2=_interopRequireDefault(_NavButton);var _Main=require("../Main");var _Main2=_interopRequireDefault(_Main);var _SetUpComponent=require("./SetUpComponent");var _SetUpComponent2=_interopRequireDefault(_SetUpComponent);var _SetUpNew=require("./SetUpNew");var _SetUpNew2=_interopRequireDefault(_SetUpNew);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var IP_MAXB="172.20.10.7";var LOCAL="95.91.211.99";var mockedData=[{question:"hallo",answer:"und hier auch die answer"},{question:"hier",answer:"und hier auch die answer1"},{question:"die",answer:"und hier auch die answer2"},{question:"question",answer:"und hier auch die answer3"},{question:"hallo hier die question",answer:"und hier auch die answer4"}];var mockedServerData=JSON.stringify(mockedData);var styles=_reactNative.StyleSheet.create({page:{flex:1},list:{alignItems:"center",paddingTop:65},input:{alignSelf:"flex-start",height:20,marginLeft:32},buttonGroup:{alignSelf:"center",height:20,margin:8}});var newId=function newId(count){return Math.random().toString(2+count).substr(2,9);};var PlayerSetUpList=function(_React$Component){_inherits(PlayerSetUpList,_React$Component);function PlayerSetUpList(props){_classCallCheck(this,PlayerSetUpList);var _this=_possibleConstructorReturn(this,(PlayerSetUpList.__proto__||Object.getPrototypeOf(PlayerSetUpList)).call(this,props));_this.isNameValid=function(name){var players=_this.state.players;var exists=(0,_ramda.find)((0,_ramda.propEq)("name",name))(players);return(0,_ramda.isNil)(exists);};_this.addPlayer=function(){var _this$state=_this.state,players=_this$state.players,count=_this$state.count;var player={name:"",sex:"m",level:0,id:newId(count)};players.push(player);count+=1;_this.setState({players:players,count:count});};_this.removePlayer=function(id){return function(){var _this$state2=_this.state,players=_this$state2.players,count=_this$state2.count;var index=(0,_ramda.findIndex)((0,_ramda.propEq)("id",id))(players);var playersList=(0,_ramda.remove)(index,1,players);_this.setState({players:playersList,count:count-1});};};_this.updatePlayer=function(id){return function(attr){return function(raw){var playersList=_this.state.players;var player=(0,_ramda.find)((0,_ramda.propEq)("id",id))(playersList);var index=(0,_ramda.findIndex)((0,_ramda.propEq)("id",id))(playersList);if(attr==="name"){var value=String(raw).trim();if(!_this.isNameValid(value)){throw new Error("Du Idiot! Name already exists...");}player[attr]=value;_reactNative.Keyboard.dismiss();}else{player[attr]=raw;}var players=(0,_ramda.update)(index,player,playersList);_this.setState({players:players});};};};_this.handleSubmit=function(){var players=JSON.stringify(_this.state.players);var encodedPlayers=encodeURI(players);var url="http://"+LOCAL+":9000/questions?players="+encodedPlayers;console.log("mocked fetch",mockedServerData);return mockedServerData;};_this.scrollToEnd=function(){_this.scrollView.scrollToEnd({animated:true});};_this.renderPlayerSetUp=function(player){var id=player.id;return _react2.default.createElement(_SetUpComponent2.default,{key:"key-"+id,player:player,setUpHandler:_this.updatePlayer(id),removeHandler:_this.removePlayer,scrollToEnd:_this.scrollToEnd,__source:{fileName:_jsxFileName,lineNumber:152}});};_this.renderPlayerSetUpList=function(n){var key=0;return(0,_ramda.times)(function(){var player=_this.state.players[key++];if(n===key){return _react2.default.createElement(_SetUpNew2.default,{key:key,setUpHandler:_this.addPlayer,__source:{fileName:_jsxFileName,lineNumber:170}});}return _this.renderPlayerSetUp(player);},n);};_this.renderSubmit=function(){var navigation=_this.props.navigation;var route={title:"Main",component:_Main2.default};return _react2.default.createElement(_NavButton2.default,{onPress:_this.handleSubmit,route:route,navigation:navigation,__source:{fileName:_jsxFileName,lineNumber:180}});};_this.state={count:1,players:[]};return _this;}_createClass(PlayerSetUpList,[{key:"render",value:function render(){var _this2=this;var count=this.state.count;return _react2.default.createElement(_reactNative.KeyboardAvoidingView,{style:styles.page,behavior:"padding",enabled:true,__source:{fileName:_jsxFileName,lineNumber:191}},_react2.default.createElement(_reactNative.ScrollView,{contentContainerStyle:styles.list,ref:function ref(_ref){return _this2.scrollView=_ref;},__source:{fileName:_jsxFileName,lineNumber:192}},this.renderPlayerSetUpList(count),this.renderSubmit()));}}]);return PlayerSetUpList;}(_react2.default.Component);exports.default=PlayerSetUpList;